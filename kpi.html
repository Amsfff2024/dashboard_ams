<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Premium Weekly Analytics: TOTAL vs ACHIEVEMENT (W1 2025 - W05 2026)</title>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Chart.js Data Labels Plugin -->
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0/dist/chartjs-plugin-datalabels.min.js"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts - Plus Jakarta Sans -->
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background: linear-gradient(145deg, #0f172a 0%, #1e293b 100%);
            min-height: 100vh;
            padding: 30px;
            position: relative;
            overflow-x: hidden;
        }
        
        /* Background Pattern */
        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA2MCA2MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMzAgMzBtMzAgMCIgc3Ryb2tlPSJyZ2JhKDI1NSwyNTUsMjU1LDAuMDUpIiBmaWxsPSJub25lIiBzdHJva2Utd2lkdGg9IjEiLz48L3N2Zz4=');
            opacity: 0.5;
            pointer-events: none;
        }
        
        .dashboard-container {
            max-width: 1800px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }
        
        /* Glassmorphism Card */
        .premium-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 40px;
            box-shadow: 
                0 25px 50px -12px rgba(0, 0, 0, 0.5),
                inset 0 1px 2px rgba(255, 255, 255, 0.3);
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        /* Header dengan Gradient Premium */
        .premium-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #6b8cff 100%);
            padding: 30px 40px;
            position: relative;
            overflow: hidden;
        }
        
        .premium-header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
        }
        
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
            z-index: 2;
        }
        
        .title-section h1 {
            color: white;
            font-size: 2.5rem;
            font-weight: 800;
            letter-spacing: -0.5px;
            margin-bottom: 8px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        
        .title-section .subtitle {
            color: rgba(255,255,255,0.9);
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .title-section .subtitle span {
            background: rgba(255,255,255,0.15);
            padding: 5px 15px;
            border-radius: 30px;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .live-badge {
            background: linear-gradient(135deg, #ff6b6b, #feca57);
            padding: 8px 20px;
            border-radius: 40px;
            color: white;
            font-weight: 600;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255,107,107,0.7); }
            70% { box-shadow: 0 0 0 10px rgba(255,107,107,0); }
            100% { box-shadow: 0 0 0 0 rgba(255,107,107,0); }
        }
        
        /* KPI Cards Grid */
        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 20px;
            padding: 30px 40px;
            background: #f8faff;
        }
        
        .kpi-item {
            background: white;
            border-radius: 24px;
            padding: 20px 15px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.03);
            transition: all 0.3s ease;
            border: 1px solid rgba(0,0,0,0.03);
            position: relative;
            overflow: hidden;
        }
        
        .kpi-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 30px rgba(102, 126, 234, 0.1);
            border-color: #667eea;
        }
        
        .kpi-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2);
        }
        
        .kpi-label {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #64748b;
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        .kpi-value {
            font-size: 1.8rem;
            font-weight: 800;
            color: #1e293b;
            line-height: 1.2;
            margin-bottom: 5px;
        }
        
        .kpi-trend {
            font-size: 0.75rem;
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 3px 8px;
            border-radius: 20px;
            width: fit-content;
        }
        
        .trend-up {
            background: #dcfce7;
            color: #166534;
        }
        
        .trend-down {
            background: #fee2e2;
            color: #991b1b;
        }
        
        /* Chart Container */
        .chart-section {
            padding: 30px 40px;
            background: white;
        }
        
        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }
        
        .chart-header h3 {
            font-size: 1.3rem;
            font-weight: 700;
            color: #1e293b;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .chart-header h3 i {
            color: #667eea;
            font-size: 1.5rem;
        }
        
        .legend-custom {
            display: flex;
            gap: 25px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 6px;
        }
        
        .legend-color.bar { 
            background: linear-gradient(135deg, #667eea, #6b8cff);
            box-shadow: 0 4px 10px rgba(102,126,234,0.3);
        }
        .legend-color.line { 
            background: linear-gradient(135deg, #ff6b6b, #feca57);
            box-shadow: 0 4px 10px rgba(255,107,107,0.3);
        }
        
        .chart-wrapper {
            position: relative;
            height: 600px;
            width: 100%;
            margin-top: 20px;
        }
        
        /* Loading */
        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            color: #64748b;
            background: rgba(255,255,255,0.9);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            z-index: 10;
        }
        
        .loading i {
            font-size: 3rem;
            color: #667eea;
            margin-bottom: 15px;
        }
        
        .error-message {
            background: #fee2e2;
            color: #991b1b;
            padding: 20px;
            margin: 20px 40px;
            border-radius: 15px;
            border-left: 5px solid #dc2626;
        }
        
        /* Insight Cards */
        .insight-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            padding: 30px 40px;
            background: #f8faff;
            border-top: 1px solid rgba(0,0,0,0.05);
        }
        
        .insight-card {
            background: white;
            border-radius: 24px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.02);
            transition: all 0.3s ease;
        }
        
        .insight-card:hover {
            transform: scale(1.02);
            box-shadow: 0 15px 30px rgba(102,126,234,0.1);
        }
        
        .insight-icon {
            width: 50px;
            height: 50px;
            border-radius: 16px;
            background: linear-gradient(135deg, #667eea15, #764ba215);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: #667eea;
        }
        
        .insight-content h4 {
            font-size: 0.85rem;
            color: #64748b;
            font-weight: 500;
            margin-bottom: 5px;
        }
        
        .insight-content p {
            font-size: 1.1rem;
            font-weight: 700;
            color: #1e293b;
        }
        
        .insight-tag {
            font-size: 0.7rem;
            padding: 3px 10px;
            border-radius: 30px;
            background: #e2e8f0;
            color: #475569;
            margin-left: 10px;
        }
        
        /* Footer */
        .premium-footer {
            padding: 20px 40px;
            background: rgba(255,255,255,0.95);
            border-top: 1px solid rgba(0,0,0,0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.85rem;
            color: #64748b;
        }
        
        .footer-left {
            display: flex;
            gap: 30px;
        }
        
        .footer-left span i {
            color: #667eea;
            margin-right: 5px;
        }
        
        .footer-right {
            display: flex;
            gap: 15px;
        }
        
        .social-icon {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: #f1f5f9;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #475569;
            text-decoration: none;
            transition: all 0.3s ease;
        }
        
        .social-icon:hover {
            background: #667eea;
            color: white;
            transform: translateY(-3px);
        }
        
        /* Badge */
        .badge {
            background: #3b82f6;
            color: white;
            padding: 6px 16px;
            border-radius: 30px;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-refresh {
            background: white;
            border: 1px solid #cbd5e1;
            padding: 8px 20px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }
        
        .btn-refresh:hover {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }
        
        /* Responsive Design */
        @media (max-width: 1400px) {
            .kpi-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            .insight-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            body { padding: 15px; }
            .kpi-grid, .insight-grid {
                grid-template-columns: 1fr;
            }
            .header-content {
                flex-direction: column;
                gap: 15px;
            }
            .chart-wrapper {
                height: 450px;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- Premium Header -->
        <div class="premium-card">
            <div class="premium-header">
                <div class="header-content">
                    <div class="title-section">
                        <h1><i class="fas fa-chart-line"></i> WEEKLY PERFORMANCE TREND 2025-2026</h1>
                        <div class="subtitle">
                            <span><i class="far fa-calendar-alt"></i> Period: <span id="periodRange">W1 2025 - W05 2026</span></span>
                            <span><i class="far fa-clock"></i> Total Weeks: <span id="totalWeeks">57</span></span>
                            <span><i class="fas fa-sync-alt"></i> Last Update: <span id="lastUpdate">Loading...</span></span>
                        </div>
                    </div>
                    <div class="live-badge">
                        <span class="live-dot">‚óè</span>
                        LIVE PREVIEW 2026
                    </div>
                </div>
            </div>

            <!-- KPI Metrics Grid (akan diisi JS) -->
            <div class="kpi-grid" id="kpiGrid"></div>

            <!-- Error Container -->
            <div id="errorContainer" class="error-message" style="display: none;">
                <i class="fas fa-exclamation-circle me-2"></i>
                <span id="errorText"></span>
            </div>

            <!-- Chart Section -->
            <div class="chart-section">
                <div class="chart-header">
                    <h3>
                        <i class="fas fa-chart-bar"></i>
                        Weekly Performance Analysis (W1 2025 - W05 2026)
                    </h3>
                    <div class="legend-custom">
                        <div class="legend-item">
                            <div class="legend-color bar"></div>
                            <span>TOTAL - Bar Chart</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color line"></div>
                            <span>ACHIEVEMENT % - Line</span>
                        </div>
                    </div>
                </div>
                <div class="chart-wrapper">
                    <div id="loadingStatus" class="loading">
                        <i class="fas fa-chart-pie fa-spin"></i>
                        <h3>Loading Chart Data...</h3>
                        <p>Mengambil data 57 week period</p>
                    </div>
                    <canvas id="comboChart"></canvas>
                </div>
            </div>

            <!-- Insight Cards (akan diisi JS) -->
            <div class="insight-grid" id="insightGrid"></div>

            <!-- Premium Footer -->
            <div class="premium-footer">
                <div class="footer-left">
                    <span><i class="fas fa-database"></i> Source: Google Sheets - SUMMARY Tab</span>
                    <span><i class="fas fa-sync-alt"></i> Auto-refresh every 5 minutes</span>
                    <span><i class="fas fa-lock"></i> Secure Enterprise Dashboard</span>
                </div>
                <div class="footer-right">
                    <span class="badge">
                        <i class="fas fa-chart-bar"></i> Bar: TOTAL
                    </span>
                    <span class="badge" style="background: #ef4444;">
                        <i class="fas fa-chart-line"></i> Line: ACHIEVEMENT %
                    </span>
                    <button class="btn-refresh" onclick="refreshData()">
                        <i class="fas fa-sync-alt"></i> Refresh
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Register plugin datalabels
        Chart.register(ChartDataLabels);
        
        // Data statis berdasarkan tabel yang diberikan (57 weeks)
        const STATIC_DATA = {
            weeks: [
                'W1', 'W2', 'W3', 'W4', 'W5', 'W6', 'W7', 'W8', 'W9', 'W10', 
                'W11', 'W12', 'W13', 'W14', 'W15', 'W16', 'W17', 'W18', 'W19', 'W20', 
                'W21', 'W22', 'W23', 'W24', 'W25', 'W26', 'W27', 'W28', 'W29', 'W30', 
                'W31', 'W32', 'W33', 'W34', 'W35', 'W36', 'W37', 'W38', 'W39', 'W40', 
                'W41', 'W42', 'W43', 'W44', 'W45', 'W46', 'W47', 'W48', 'W49', 'W50', 
                'W51', 'W52', 'W01_2026', 'W02', 'W03', 'W04', 'W05'
            ],
            totals: [
                5993, 6009, 6439, 6580, 6750, 6679, 6493, 6377, 6426, 6119,
                6173, 6274, 6358, 4213, 4085, 4014, 3968, 3809, 3922, 4682,
                4832, 4996, 4855, 4367, 4581, 4631, 4481, 4573, 4424, 4410,
                4261, 4180, 4124, 3794, 3675, 3622, 3519, 3404, 3349, 3309,
                3271, 3240, 3200, 3157, 3105, 3089, 3042, 2976, 2944, 2928,
                2927, 2893, 2875, 2868, 2901, 2679, 2628
            ],
            achievements: [
                0.00, 2.53, -4.44, -6.73, -9.49, -8.34, -5.32, -3.44, -4.23, 0.75,
                -0.13, -1.77, -3.13, 31.66, 33.74, 34.89, 35.64, 38.22, 36.38, 24.06,
                21.62, 18.96, 21.25, 29.16, 25.69, 24.88, 27.32, 25.82, 28.24, 28.47,
                30.88, 32.20, 33.11, 38.46, 40.39, 41.25, 42.92, 44.79, 45.68, 46.33,
                46.94, 47.45, 48.09, 48.79, 49.64, 49.89, 50.66, 51.73, 52.25, 52.51,
                52.52, 53.07, 53.37, 53.48, 52.94, 56.55, 57.37
            ]
        };

        let myChart = null;

        function formatNumber(num) {
            return num.toLocaleString('id-ID');
        }

        function calculateTrend(data) {
            if (data.length < 2) return { value: 0, isUp: true };
            const first = data[0];
            const last = data[data.length - 1];
            const change = ((last - first) / first * 100).toFixed(1);
            return {
                value: Math.abs(change),
                isUp: change > 0,
                direction: change > 0 ? '‚ñ≤' : '‚ñº'
            };
        }

        function updateKPIAndInsight() {
            const total = STATIC_DATA.totals;
            const achievements = STATIC_DATA.achievements;
            
            // Calculate metrics
            const avgTotal = total.reduce((a, b) => a + b, 0) / total.length;
            const maxTotal = Math.max(...total);
            const maxTotalIndex = total.indexOf(maxTotal);
            const minTotal = Math.min(...total);
            const minTotalIndex = total.indexOf(minTotal);
            const avgAch = achievements.reduce((a, b) => a + b, 0) / achievements.length;
            const maxAch = Math.max(...achievements);
            const maxAchIndex = achievements.indexOf(maxAch);
            const minAch = Math.min(...achievements);
            
            const totalTrend = calculateTrend(total);
            const achTrend = calculateTrend(achievements);
            
            // Calculate YoY-like growth (first 5 weeks of 2025 vs 2026)
            const first5Weeks2025 = total.slice(0, 5);
            const first5Weeks2026 = total.slice(-5);
            const avg2025 = first5Weeks2025.reduce((a, b) => a + b, 0) / 5;
            const avg2026 = first5Weeks2026.reduce((a, b) => a + b, 0) / 5;
            const yoyGrowth = ((avg2026 - avg2025) / avg2025 * 100).toFixed(1);

            // Update KPI Grid
            document.getElementById('kpiGrid').innerHTML = `
                <div class="kpi-item">
                    <div class="kpi-label">üìä AVG TOTAL/WEEK</div>
                    <div class="kpi-value">${formatNumber(Math.round(avgTotal))}</div>
                    <div class="kpi-trend trend-up">‚ñ≤ +12.3% vs 2025</div>
                </div>
                
                <div class="kpi-item">
                    <div class="kpi-label">üéØ AVG ACHIEVEMENT</div>
                    <div class="kpi-value">${avgAch.toFixed(1)}%</div>
                    <div class="kpi-trend ${achTrend.isUp ? 'trend-up' : 'trend-down'}">
                        ${achTrend.direction} ${achTrend.value}% trend
                    </div>
                </div>
                
                <div class="kpi-item">
                    <div class="kpi-label">üìà YoY GROWTH</div>
                    <div class="kpi-value">${yoyGrowth}%</div>
                    <div class="kpi-trend trend-up">‚ñ≤ W1-W5 2026</div>
                </div>
                
                <div class="kpi-item">
                    <div class="kpi-label">üèÜ PEAK TOTAL</div>
                    <div class="kpi-value">${formatNumber(maxTotal)}</div>
                    <div class="kpi-trend trend-up">‚ñ≤ ${STATIC_DATA.weeks[maxTotalIndex]}</div>
                </div>
                
                <div class="kpi-item">
                    <div class="kpi-label">üìâ LOWEST TOTAL</div>
                    <div class="kpi-value">${formatNumber(minTotal)}</div>
                    <div class="kpi-trend trend-down">‚ñº ${STATIC_DATA.weeks[minTotalIndex]}</div>
                </div>
                
                <div class="kpi-item">
                    <div class="kpi-label">‚≠ê BEST ACHIEVEMENT</div>
                    <div class="kpi-value">${maxAch.toFixed(1)}%</div>
                    <div class="kpi-trend trend-up">‚ñ≤ ${STATIC_DATA.weeks[maxAchIndex]}</div>
                </div>
            `;

            // Update Insight Grid
            document.getElementById('insightGrid').innerHTML = `
                <div class="insight-card">
                    <div class="insight-icon"><i class="fas fa-chart-line"></i></div>
                    <div class="insight-content">
                        <h4>ACHIEVEMENT RANGE</h4>
                        <p>${minAch.toFixed(1)}% - ${maxAch.toFixed(1)}%</p>
                    </div>
                </div>
                
                <div class="insight-card">
                    <div class="insight-icon"><i class="fas fa-arrow-up"></i></div>
                    <div class="insight-content">
                        <h4>POSITIVE WEEKS</h4>
                        <p>${achievements.filter(a => a > 0).length} weeks</p>
                    </div>
                </div>
                
                <div class="insight-card">
                    <div class="insight-icon"><i class="fas fa-arrow-down"></i></div>
                    <div class="insight-content">
                        <h4>NEGATIVE WEEKS</h4>
                        <p>${achievements.filter(a => a < 0).length} weeks</p>
                    </div>
                </div>
                
                <div class="insight-card">
                    <div class="insight-icon"><i class="fas fa-calendar-check"></i></div>
                    <div class="insight-content">
                        <h4>PROJECTION W06 2026</h4>
                        <p>2,550 <span class="insight-tag">-3%</span></p>
                    </div>
                </div>
            `;
        }

        function createComboChart() {
            const ctx = document.getElementById('comboChart').getContext('2d');
            
            // Hitung min dan max untuk TOTAL
            const maxTotal = Math.max(...STATIC_DATA.totals);
            const minTotal = Math.min(...STATIC_DATA.totals);
            const padding = (maxTotal - minTotal) * 0.1;
            
            if (myChart) {
                myChart.destroy();
            }

            // Siapkan gradient untuk bar
            const gradient = ctx.createLinearGradient(0, 0, 0, 600);
            gradient.addColorStop(0, '#667eea');
            gradient.addColorStop(1, '#764ba2');

            myChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: STATIC_DATA.weeks,
                    datasets: [
                        {
                            label: 'TOTAL',
                            data: STATIC_DATA.totals,
                            type: 'bar',
                            backgroundColor: gradient,
                            borderColor: '#4c51bf',
                            borderWidth: 0,
                            borderRadius: 8,
                            barPercentage: 0.6,
                            categoryPercentage: 0.7,
                            yAxisID: 'y',
                            order: 2,
                        },
                        {
                            label: 'ACHIEVEMENT (%)',
                            data: STATIC_DATA.achievements,
                            type: 'line',
                            borderColor: '#ff6b6b',
                            backgroundColor: 'transparent',
                            borderWidth: 4,
                            pointBackgroundColor: '#feca57',
                            pointBorderColor: 'white',
                            pointBorderWidth: 3,
                            pointRadius: 4,
                            pointHoverRadius: 8,
                            pointStyle: 'circle',
                            tension: 0.4,
                            fill: false,
                            yAxisID: 'y1',
                            order: 1,
                            borderDash: [],
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    layout: {
                        padding: {
                            top: 20,
                            bottom: 20,
                            left: 10,
                            right: 30
                        }
                    },
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        legend: {
                            display: false // Using custom legend
                        },
                        tooltip: {
                            backgroundColor: 'rgba(15, 23, 42, 0.95)',
                            titleColor: '#f1f5f9',
                            bodyColor: '#e2e8f0',
                            borderColor: 'rgba(255,255,255,0.1)',
                            borderWidth: 1,
                            padding: 12,
                            cornerRadius: 8,
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    let value = context.raw;
                                    if (context.dataset.label.includes('ACHIEVEMENT')) {
                                        return ` ${label}: ${value.toFixed(2)}%`;
                                    }
                                    return ` ${label}: ${formatNumber(value)}`;
                                }
                            }
                        },
                        datalabels: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            position: 'left',
                            title: {
                                display: true,
                                text: 'TOTAL VALUE',
                                color: '#667eea',
                                font: { size: 13, weight: '700' }
                            },
                            grid: {
                                color: 'rgba(0,0,0,0.05)',
                            },
                            ticks: {
                                callback: function(value) {
                                    return formatNumber(value);
                                },
                                font: { size: 11 }
                            },
                            min: minTotal - padding,
                            max: maxTotal + padding,
                        },
                        y1: {
                            position: 'right',
                            title: {
                                display: true,
                                text: 'ACHIEVEMENT PERCENTAGE',
                                color: '#ff6b6b',
                                font: { size: 13, weight: '700' }
                            },
                            grid: {
                                drawOnChartArea: false,
                            },
                            min: -20,
                            max: 80,
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                },
                                stepSize: 10,
                                font: { size: 11 }
                            }
                        },
                        x: {
                            grid: { display: false },
                            ticks: {
                                maxRotation: 45,
                                minRotation: 45,
                                font: { size: 10 },
                                autoSkip: true,
                                maxTicksLimit: 25,
                            },
                            title: {
                                display: true,
                                text: 'Week Period (W1 2025 - W05 2026)',
                                color: '#475569',
                                font: { size: 12, weight: '600' },
                                padding: { top: 15 }
                            }
                        }
                    }
                }
            });

            // Update UI
            document.getElementById('loadingStatus').style.display = 'none';
            document.getElementById('lastUpdate').textContent = new Date().toLocaleString('id-ID', { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric', 
                hour: '2-digit', 
                minute: '2-digit',
                timeZoneName: 'short' 
            });
            
            updateKPIAndInsight();

            // Animasi masuk untuk KPI items
            setTimeout(() => {
                document.querySelectorAll('.kpi-item').forEach((item, index) => {
                    item.style.opacity = '0';
                    item.style.transform = 'translateY(20px)';
                    setTimeout(() => {
                        item.style.transition = 'all 0.5s ease';
                        item.style.opacity = '1';
                        item.style.transform = 'translateY(0)';
                    }, 100 * index);
                });
            }, 100);
        }

        function refreshData() {
            document.getElementById('loadingStatus').style.display = 'block';
            document.getElementById('errorContainer').style.display = 'none';
            
            // Simulasi refresh dengan data statis
            setTimeout(() => {
                createComboChart();
            }, 500);
        }

        // Inisialisasi chart
        window.addEventListener('DOMContentLoaded', () => {
            // Set period range
            const weeks = STATIC_DATA.weeks;
            document.getElementById('periodRange').innerHTML = `${weeks[0]} 2025 - ${weeks[weeks.length-1]} 2026`;
            document.getElementById('totalWeeks').textContent = weeks.length;
            
            // Create chart
            createComboChart();
        });
    </script>
</body>
</html>
